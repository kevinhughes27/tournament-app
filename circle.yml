machine:
  environment:
    ENV: circleci
    RACK_ENV: test
    RAILS_ENV: test
  ruby:
    version:
      2.2.2

dependencies:
  pre:
    - mkdir -p tmp/cache
  post:
    - npm install
    - bower install
  override:
    - bundle install --path .bundle --without production --without development
  cache_directories:
    - ".bundle"
    - "node_modules"
    - "vendor/bower_components"

database:
  override:
    - bundle exec rake db:setup --trace

test:
  post:
    - bundle exec rake spec:javascript
